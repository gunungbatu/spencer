<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery | Spencer Green Hotel Batu</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <script src="assets/js/global-config.js"></script>

    <style>
        :root { --gold: #D4AF37; --emerald: #1B4D3E; --dark: #1a1a1a; --light: #F9F9F9; }
        body { font-family: 'Montserrat', sans-serif; color: #4a4a4a; background: var(--light); margin:0; }
        h1, h2, h3 { font-family: 'Cormorant Garamond', serif; color: var(--dark); }

        /* HEADER FIX: Kita hanya atur style dasar agar tidak berantakan sebelum JS load */
        #global-header-container { min-height: 80px; }

        /* HERO */
        .hero-gallery { height:60vh; background:linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('assets/gallery-bg.jpg'); background-size:cover; background-position:center; display:flex; align-items:center; justify-content:center; text-align:center; transition:0.5s; }
        .hero-title { color:#fff; font-size:4rem; margin:0; letter-spacing:3px; } .hero-subtitle { color:var(--gold); letter-spacing:3px; font-weight:600; }

        /* GALLERY FILTER */
        .gallery-section { padding:80px 50px; max-width:1200px; margin:0 auto; min-height: 600px; }
        .filter-nav { text-align:center; margin-bottom:50px; display:flex; justify-content:center; gap:15px; flex-wrap:wrap; }
        .filter-btn { background:none; border:none; padding:10px 20px; font-size:0.9rem; font-weight:500; cursor:pointer; color:#888; transition:0.3s; border-bottom:2px solid transparent; text-transform:uppercase; letter-spacing:1px; }
        .filter-btn.active, .filter-btn:hover { color:var(--emerald); border-color:var(--gold); }

        /* GRID SYSTEM */
        .gallery-grid { display:grid; grid-template-columns:repeat(3, 1fr); gap:20px; }
        .gallery-item { overflow:hidden; position:relative; cursor:pointer; height:250px; border-radius:4px; box-shadow:0 5px 15px rgba(0,0,0,0.1); }
        .gallery-item img { width:100%; height:100%; object-fit:cover; display:block; transition:0.5s; }
        .gallery-item:hover img { transform:scale(1.1); }
        
        /* Zoom Icon Overlay */
        .zoom-icon { position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.4); display:flex; justify-content:center; align-items:center; opacity:0; transition:0.3s; }
        .zoom-icon i { color:#fff; font-size:2rem; border:2px solid #fff; padding:15px; border-radius:50%; }
        .gallery-item:hover .zoom-icon { opacity:1; }

        /* LIGHTBOX */
        .lightbox { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:9999; justify-content:center; align-items:center; flex-direction:column; }
        .lightbox.active { display:flex; animation:fadeIn 0.3s; }
        .lightbox img { max-width:90%; max-height:80vh; border:4px solid #fff; box-shadow:0 0 30px rgba(0,0,0,0.5); }
        .close-lb { position:absolute; top:30px; right:40px; color:#fff; font-size:3rem; cursor:pointer; }
        .lb-tag { color:var(--gold); font-family:'Cormorant Garamond'; font-size:1.5rem; margin-top:20px; text-transform:uppercase; letter-spacing:2px; }
        @keyframes fadeIn { from{opacity:0} to{opacity:1} }

        /* FOOTER & SOCIAL ICONS */
        footer { background:var(--emerald); color:#fff; padding:50px; text-align:center; margin-top:auto; }
        .social-box { display:flex; justify-content:center; gap:20px; margin-top:20px; }
        .social-icon { color:#fff; width:40px; height:40px; border:1px solid rgba(255,255,255,0.3); border-radius:50%; display:flex; align-items:center; justify-content:center; transition:0.3s; text-decoration:none; }
        .social-icon:hover { background:var(--gold); border-color:var(--gold); transform:translateY(-3px); }

        @media(max-width:900px) { 
            .gallery-grid { grid-template-columns:1fr; } 
            .hero-title { font-size: 3rem; }
        }
    </style>
</head>
<body data-page="gallery">

    <div id="global-header-container"></div>

    <section class="hero-gallery" id="img_gallery_hero">
        <div>
            <p class="hero-subtitle" id="gallery_subtitle">Explore The Beauty</p>
            <h1 class="hero-title" id="gallery_title">Visual Journey</h1>
        </div>
    </section>

    <section class="gallery-section">
        <div class="filter-nav" id="filter-container">
            </div>

        <div class="gallery-grid" id="gallery-container">
            </div>
    </section>

    <div class="lightbox" id="lightbox" onclick="closeLightbox()">
        <span class="close-lb">&times;</span>
        <img id="lb-img" src="">
        <div class="lb-tag" id="lb-tag"></div>
    </div>

    <footer id="global-footer"></footer>

    <script>
        fetch('data.json?t=' + new Date().getTime())
        .then(r => r.json())
        .then(data => {
            // 1. Setup Header Content
            document.getElementById('gallery_title').innerText = data.gallery_title;
            document.getElementById('gallery_subtitle').innerText = data.gallery_subtitle;
            document.getElementById('img_gallery_hero').style.backgroundImage = `linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('${data.img_gallery_hero}')`;

            // 2. Setup Filters (Dynamic Tags)
            const tags = (data.gallery_tags || "All, Rooms, Dining, MICE").split(',').map(t => t.trim());
            const filterCont = document.getElementById('filter-container');
            
            // Tambahkan tombol "All" dulu jika belum ada
            if(!tags.includes('All')) tags.unshift('All'); 

            tags.forEach((tag, idx) => {
                const btn = document.createElement('button');
                btn.className = `filter-btn ${tag === 'All' ? 'active' : ''}`;
                btn.innerText = tag;
                btn.onclick = (e) => filterGallery(tag, e.target);
                filterCont.appendChild(btn);
            });

            // 3. Setup Grid Images (Unlimited Array)
            const grid = document.getElementById('gallery-container');
            const items = data.gallery_items || [];

            // Jika array kosong, fallback ke slot lama (untuk kompatibilitas)
            if (items.length === 0) {
                for (let i = 1; i <= 12; i++) {
                    if (data[`img_gallery_${i}`]) {
                        items.push({ src: data[`img_gallery_${i}`], tag: "General" });
                    }
                }
            }

            items.forEach(item => {
                // Bersihkan spasi pada tag untuk class CSS
                const tagClass = item.tag ? item.tag.replace(/\s+/g, '') : 'General';
                
                const div = document.createElement('div');
                div.className = `gallery-item ${tagClass}`;
                div.setAttribute('data-tag', item.tag || 'General'); // Simpan tag asli
                div.onclick = () => openLightbox(item.src, item.tag);
                
                div.innerHTML = `
                    <img src="${item.src}" alt="${item.tag}">
                    <div class="zoom-icon"><i class="fas fa-search-plus"></i></div>
                `;
                grid.appendChild(div);
            });
        });

        // --- FILTER FUNCTION ---
        function filterGallery(category, btn) {
            // Update Active Button
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            // Show/Hide Items
            const items = document.querySelectorAll('.gallery-item');
            items.forEach(item => {
                const itemTag = item.getAttribute('data-tag');
                // Logic: Tampilkan jika kategori 'All' ATAU tag sama (case insensitive)
                const match = category === 'All' || (itemTag && itemTag.toLowerCase() === category.toLowerCase());
                
                if (match) {
                    item.style.display = 'block';
                    // Animasi Fade In
                    item.style.opacity = '0';
                    setTimeout(() => item.style.opacity = '1', 50);
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // --- LIGHTBOX FUNCTION ---
        function openLightbox(src, tag) {
            document.getElementById('lb-img').src = src;
            document.getElementById('lb-tag').innerText = tag || "";
            document.getElementById('lightbox').classList.add('active');
        }
        function closeLightbox() {
            document.getElementById('lightbox').classList.remove('active');
        }
    </script>
</body>
</html>
